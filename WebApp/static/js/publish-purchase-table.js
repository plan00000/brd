function checkCategoryname(a){if(a.val().length==0||a.val().length>80){a.css("border","1px solid red");return false}if(CommValidate.checkQuote2(a.val())){a.css("border","1px solid red");return false}a.removeAttr("style");return true}function checkDiameter(c,b){var a=b.val();if(a==1){return true}if(c.val().length==0){c.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(c.val())&&!CommValidate.isPositiveInteger(c.val())){c.css("border","1px solid red");return false}if(c.val().length>8){c.css("border","1px solid red");return false}c.css("border","");return true}function checkMijing(c,b){var a=b.val();if(a==0){return true}if(c.val().length==0){c.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(c.val())&&!CommValidate.isPositiveInteger(c.val())){c.css("border","1px solid red");return false}if(c.val().length>8){c.css("border","1px solid red");return false}c.css("border","");return true}function checkHeight(a){if(a.val().length==0){a.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(a.val())&&!CommValidate.isPositiveInteger(a.val())){a.css("border","1px solid red");return false}if(a.val().length>8){a.css("border","1px solid red");return false}a.removeAttr("style");return true}function checkCrown(a){if(a.val().length==0){a.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(a.val())&&!CommValidate.isPositiveInteger(a.val())){a.css("border","1px solid red");return false}if(a.val().length>8){a.css("border","1px solid red");return false}a.removeAttr("style");return true}function checkOffbarHeight(a){if(a.val().length==0){a.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(a.val())&&!CommValidate.isPositiveInteger(a.val())){a.css("border","1px solid red");return false}if(a.val().length>8){a.css("border","1px solid red");return false}a.removeAttr("style");return true}function checkSoilballDiameter(a){if(a.val().length==0){a.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(a.val())&&!CommValidate.isPositiveInteger(a.val())){a.css("border","1px solid red");return false}if(a.val().length>8){a.css("border","1px solid red");return false}a.removeAttr("style");return true}function checkSoilballDepth(a){if(a.val().length==0){a.css("border","1px solid red");return false}if(!CommValidate.isPositiveDouble(a.val())&&!CommValidate.isPositiveInteger(a.val())){a.css("border","1px solid red");return false}if(a.val().length>8){a.css("border","1px solid red");return false}a.removeAttr("style");return true}function checkPurchases(c,b){if(CommValidate.isNullStr(c.val())){c.css("border","1px solid red");return 1}var a=CommValidate.checkUnit(b.find("option:selected").text(),c.val());if(a!=0){c.css("border","1px solid red");return a}c.removeAttr("style");return a}function checkRequirements(a){if(a.val().length>254){a.css("border","1px solid red");return false}return true}function changeTypes(d,a,b){if(d.length==0){return}var c=d.val();if(c==0){a.css("display","inline-block");b.css("display","none");b.val("")}else{b.css("display","inline-block");a.css("display","none");a.val("")}}function addDmListener(c,a,b){changeTypes(c,a,b);c.change(function(){var d=c.val();if(d==0){a.css("display","inline-block");b.css("display","none");b.val("")}else{b.css("display","inline-block");a.css("display","none");a.val("")}})}function insertRowLast(d){var c=$(d+" tr").length;if(c>0){c=c-1}var a='<tr><td><input autocomplete="off" type="text" id="categoryname"  name="purchasedetailList['+c+"].categoryname\" maxLength=80 onchange='isremind(this)' onfocus='bindAutocomplete(this)'></td><td><select style=\"width:52px;\"  dmType=\""+c+'dmType"><option value="1">米径</option><option value="0">地径</option></select> <input autocomplete="off" style="width:40px;" type="text" id="diameter"  name="purchasedetailList['+c+'].seedlingsbaseinfo.diameter" maxLength=8 onchange=\'isremind(this)\'><input autocomplete="off" style="width:40px;display: none;" type="text" id="mijing"  name="purchasedetailList['+c+'].seedlingsbaseinfo.mijing" maxLength=8 onchange=\'isremind(this)\'></td><td><input autocomplete="off" type="text" id="height"  name="purchasedetailList['+c+'].seedlingsbaseinfo.height" maxLength=8 onchange=\'isremind(this)\'></td><td><input autocomplete="off" type="text" id="crown"  name="purchasedetailList['+c+'].seedlingsbaseinfo.crown" maxLength=8 onchange=\'isremind(this)\'></td><td><input autocomplete="off" type="text" id="offbarHeight"  name="purchasedetailList['+c+'].seedlingsbaseinfo.offbarHeight" maxLength=8 onchange=\'isremind(this)\'></td><td class="inw"><input autocomplete="off" placeholder="直径" type="text" id="soilballDiameter"  name="purchasedetailList['+c+'].seedlingsbaseinfo.soilballDiameter" maxLength=8 onchange=\'isremind(this)\'>&nbsp;<input autocomplete="off" placeholder="深度" type="text" id="soilballDepth"  name="purchasedetailList['+c+"].seedlingsbaseinfo.soilballDepth\" maxLength=8 onchange='isremind(this)'></td><td><select   name=\"purchasedetailList["+c+'].seedlingsbaseinfo.plantingType"><option value="0">无要求</option><option value="1">容器苗</option><option value="2">地栽苗</option><option value="3">移植苗</option></select></td><td><input autocomplete="off" type="text" id="purchases"  name="purchasedetailList['+c+"].purchases\" maxLength=8 onchange='isremind(this)'></td><td><select   name=\"purchasedetailList["+c+'].seedlingsbaseinfo.unit"><option value="0">株</option><option value="1">丛</option><option value="2">平方米</option></select></td><td class="t-txt" ><input type="text" autocomplete="off" maxlength="255" id="requirements"  name="purchasedetailList['+c+'].requirements" onchange=\'isremind(this)\' /></td><td class="t-btn"><a href="javascript:void(0)" name="del" onclick="delOneRow(this);">删除</a></td></tr>';
$(d+" tbody").find("tr:last").after(a);var b=$(d+" tbody").find("tr");b.each(function(e){$(this).find("td").each(function(){addDmListener($(this).find("select[dmType*='dmType']"),$(this).find("input[name*='diameter']"),$(this).find("input[name*='mijing']"))})})}function delOneRow(a){$(a).parent().parent().remove()}function editOneRow(a){var b=$(a).parent("td").parent("tr").prevAll().length;$(a).parent().parent().find("td").each(function(){$(this).find("input[name*=categoryname]").removeAttr("readonly");$(this).find("input[name*=categoryname]").removeAttr("style");var d=$(this).find("select[dmType*=dmType]");var c=d.val();if(c==0){$(this).find("input[name*=diameter]").removeAttr("readonly");$(this).find("input[name*=diameter]").removeAttr("style")}else{$(this).find("input[name*=mijing]").removeAttr("readonly");$(this).find("input[name*=mijing]").removeAttr("style")}$(this).find("input[name*=height]").removeAttr("readonly");$(this).find("input[name*=height]").removeAttr("style");$(this).find("input[name*=crown]").removeAttr("readonly");$(this).find("input[name*=crown]").removeAttr("style");$(this).find("input[name*=offbarHeight]").removeAttr("readonly");$(this).find("input[name*=offbarHeight]").removeAttr("style");$(this).find("input[name*=soilballDiameter]").removeAttr("readonly");$(this).find("input[name*=soilballDiameter]").removeAttr("style");$(this).find("input[name*=soilballDepth]").removeAttr("readonly");$(this).find("input[name*=soilballDepth]").removeAttr("style");$(this).find("input[name*=purchases]").removeAttr("readonly");$(this).find("input[name*=purchases]").removeAttr("style");$(this).find("input[name*=requirements]").removeAttr("readonly");$(this).find("input[name*=requirements]").removeAttr("style");$(this).find("select[dmType*=dmType]").removeAttr("onchange");$(this).find("select[dmType*=dmType]").removeAttr("onfocus");$(this).find("select[dmType*=dmType]").removeAttr("disabled");$(this).find("select[name*=plantingType]").removeAttr("onchange");$(this).find("select[name*=plantingType]").removeAttr("onfocus");$(this).find("select[name*=plantingType]").removeAttr("disabled");$(this).find("select[name*=unit]").removeAttr("onfocus");$(this).find("select[name*=unit]").removeAttr("onchange");$(this).find("select[name*=unit]").removeAttr("disabled");$(this).find("a[name=edit]").css("display","none");$(this).find("a[name=noEdit]").css("display","block")})}function noEditOneRow(b){var e=$(b).parent("td").parent("tr").prevAll().length;var a=true;var c=0;var d;$(b).parent().parent().find("td").each(function(){var p=$(this).find("input[name*=categoryname]");if(p.val()!==undefined){if(!checkCategoryname(p)){a=false;return a}}var g=$(this).find("select[dmType*=dmType]");var q=$(this).find("input[name*=diameter]");if(q.val()!==undefined){if(!CommValidate.isNullStr(q.val())){c=c+1;if(!checkDiameter(q,g)){a=false;return a}}else{if(g.val()==0){q.removeAttr("style")}}}var m=$(this).find("input[name*=mijing]");if(m.val()!==undefined){if(!CommValidate.isNullStr(m.val())){c=c+1;if(!checkMijing(m,g)){a=false;return a}}else{if(g.val()==1){m.removeAttr("style")}}}var n=$(this).find("input[name*=height]");if(n.val()!==undefined){if(!CommValidate.isNullStr(n.val())){c=c+1;if(!checkHeight(n)){a=false;return a}}else{n.removeAttr("style")}}var l=$(this).find("input[name*=crown]");if(l.val()!==undefined){if(!CommValidate.isNullStr(l.val())){c=c+1;if(!checkCrown(l)){a=false;return a}}else{l.removeAttr("style")}}var h=$(this).find("input[name*=offbarHeight]");if(h.val()!==undefined){if(!CommValidate.isNullStr(h.val())){c=c+1;if(!checkOffbarHeight(h)){a=false;return a}}else{h.removeAttr("style")}}var f=$(this).find("input[name*=soilballDiameter]");if(f.val()!==undefined){if(!CommValidate.isNullStr(f.val())){c=c+1;if(!checkSoilballDiameter(f)){a=false;return a}}else{f.removeAttr("style")}}var o=$(this).find("input[name*=soilballDepth]");if(o.val()!==undefined){if(!CommValidate.isNullStr(o.val())){c=c+1;if(!checkSoilballDepth(o)){a=false;return a}}else{o.removeAttr("style")}}var i=$(this).find("input[name*=purchases]");if(i.val()!==undefined){d=i}var k=$(this).find("select[name*=unit]");if(d!==undefined&&d.val()!==undefined&&k.val()!==undefined){var j=checkPurchases(d,k);if(j!=0){a=false;return a}}});if(c==0){showDialogWithOk("苗木规格至少有一项不能为空！");return}if(a){$(b).parent().parent().find("td").each(function(){$(this).find("input[name*=categoryname]").attr("readonly","readonly");$(this).find("input[name*=categoryname]").css("border-style","none");$(this).find("input[name*=diameter]").attr("readonly","readonly");$(this).find("input[name*=diameter]").css("border-style","none");$(this).find("input[name*=mijing]").attr("readonly","readonly");$(this).find("input[name*=mijing]").css("border-style","none");$(this).find("input[name*=height]").attr("readonly","readonly");$(this).find("input[name*=height]").css("border-style","none");$(this).find("input[name*=crown]").attr("readonly","readonly");$(this).find("input[name*=crown]").css("border-style","none");
$(this).find("input[name*=offbarHeight]").attr("readonly","readonly");$(this).find("input[name*=offbarHeight]").css("border-style","none");$(this).find("input[name*=soilballDiameter]").attr("readonly","readonly");$(this).find("input[name*=soilballDiameter]").css("border-style","none");$(this).find("input[name*=soilballDepth]").attr("readonly","readonly");$(this).find("input[name*=soilballDepth]").css("border-style","none");$(this).find("input[name*=purchases]").attr("readonly","readonly");$(this).find("input[name*=purchases]").css("border-style","none");$(this).find("input[name*=requirements]").attr("readonly","readonly");$(this).find("input[name*=requirements]").css("border-style","none");$(this).find("input[name*=requirements]").css("resize","none");$(this).find("input[name*=requirements]").css("outline","none");$(this).find("select[dmType*=dmType]").attr("onfocus","this.defaultIndex=this.selectedIndex");$(this).find("select[dmType*=dmType]").attr("onchange","this.selectedIndex=this.defaultIndex");$(this).find("select[dmType*=dmType]").attr("disabled","disabled");$(this).find("select[name*=plantingType]").attr("onfocus","this.defaultIndex=this.selectedIndex");$(this).find("select[name*=plantingType]").attr("onchange","this.selectedIndex=this.defaultIndex");$(this).find("select[name*=plantingType]").attr("disabled","disabled");$(this).find("select[name*=unit]").attr("disabled","disabled");$(this).find("select[name*=unit]").attr("onfocus","this.defaultIndex=this.selectedIndex");$(this).find("select[name*=unit]").attr("onchange","this.selectedIndex=this.defaultIndex");$(this).find("a[name=edit]").css("display","block");$(this).find("a[name=noEdit]").css("display","none")})}}function checkTable(f){$(f+"").data("empty",false);var d=$(f+" tbody").find("tr");var b=true;var e=0;var a=d.length;var c=false;d.each(function(h){var j;var g=0;$(this).find("td").each(function(){var u=$(this).find("input[name*=categoryname]");if(u.val()!==undefined){if(!checkCategoryname(u)){b=false}}var k=$(this).find("select[dmType*=dmType]");var v=$(this).find("input[name*=diameter]");if(v.val()!==undefined){if(!CommValidate.isNullStr(v.val())){g++;e=e+1;if(!checkDiameter(v,k)){b=false}}}var r=$(this).find("input[name*=mijing]");if(r.val()!==undefined){if(!CommValidate.isNullStr(r.val())){g++;e=e+1;if(!checkMijing(r,k)){b=false}}}var s=$(this).find("input[name*=height]");if(s.val()!==undefined){if(!CommValidate.isNullStr(s.val())){g++;e=e+1;if(!checkHeight(s)){b=false}}}var q=$(this).find("input[name*=crown]");if(q.val()!==undefined){if(!CommValidate.isNullStr(q.val())){g++;e=e+1;if(!checkCrown(q)){b=false}}}var m=$(this).find("input[name*=offbarHeight]");if(m.val()!==undefined){if(!CommValidate.isNullStr(m.val())){g++;e=e+1;if(!checkOffbarHeight(m)){b=false}}}var i=$(this).find("input[name*=soilballDiameter]");var t=$(this).find("input[name*=soilballDepth]");if(!((i.val()==undefined||CommValidate.isNullStr(i.val()))&&(t.val()==undefined||CommValidate.isNullStr(t.val())))){if(!checkSoilballDiameter(i)||!checkSoilballDepth(t)){b=false;c=true}else{g++;e=e+1}}$(this).find("select[name*=plantingType]").removeAttr("disabled");$(this).find("select[dmType*=dmType]").removeAttr("disabled");$(this).find("select[name*=unit]").removeAttr("disabled");var n=$(this).find("input[name*=purchases]");if(n.val()!==undefined){j=n}var p=$(this).find("select[name*=unit]");if(j!==undefined&&j.val()!==undefined&&p.val()!==undefined){var o=checkPurchases(j,p);if(o!=0){b=false}}var l=$(this).find("input[name*=requirements]");if(l.val()!==undefined){if(!checkRequirements(l)){b=false}}});if(h!=0){if(g==0){$(f+"").data("empty",true)}else{if(c){showDialogWithOk("土球规格必须完整填写！");b=false;return false}}}if(((a-1)==h)){if(a==1){showDialogWithOk("请至少添加一条苗木要求！");b=false}}});return b};